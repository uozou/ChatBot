import requests
from pyChatGPT import ChatGPT
import time

session_token = 'eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..cjVqlyHLFQ70RjSa.2l6jHieZv17paHklG1xMnP9tN4yyL4bqNFgAD78mxPq_1EA8cAouaX3hV1curfCVnabA_FCRN_-8NkWwadIZQwQsNIdaY9xDuXE4SjFAbOE8j105FjPB65g2vxaXnKwSLw7u-YFqvzEmf_x-Hz16hDFdaUx7tQQ1Z8Lf27sUP0YEta-KvA3DD-D4f1Rk7d-YG0d3sb5WGstx_2Yskjaz2LIm_oCbcXPCWlYGItuCwqDWN_Wtu7nKii3Fq39WLH3RgfDvJMOwCf6tRrG9NbuxQeeT7MICjXnViJkgsiNSVKE7remFKxiYQmecrAyEfQX6GH9QpDFNB5QTVAsanejV9dldaBVL6BRWyUQrxgPMxAMhoh0W3nDJwArnrrMH1JqhwNIGK5kTjmyg6lTjmQ3NCsu5mR72WZEDTFqWhLynL9EodZx6GKLbu9yIOIV5x_OWYiTjGhMjkXBtBfPQ4Du2R6LJNhCActgqyFBepa-76EV9fwi9qt8GcfQbM7jW_9XDMer3zHEAFCl5Q5irU4S92v_iggjRt9WOsOzPpNDdOpLhcLqiJaJIKzYASgDSToSuUVIerQ8k2v2ZOGnNf8_MHqTpy0LHtIeAK8nPx_YusWBcSiIRmKTGgbS3Uz0_zD0skd_L2KW6f7xDAEFKSEkPAOdmTJLR15bQQEBqyQQrpcdXrL2cEEpIZj1tpHaL65F5ORnBTSeF6NSZeofy-eCU6j9YtTnj5mEnhjS30NQgeE-JGpmgp4n1n6_40cD55eibJPvV_VCFVfT2VopKTWQENoja8lr8QevzO0nZWJ6bmueD42N4R4wQo8MPi8C4dEBJiAeL7MooOd2Zhfbnr7DijuEKgL-t7WpJ80JbrFsdLd8f0CAu7T5Yh7iCwJIjuWpr6-8fkfptn1_dfgYz_YxM7Y65AM9dyYu7C6E6gENUyVLXTfMlCvmyEIJyLlVuKbIBJL-8IkYfxLCkXsTSEd8kANdCqa82vSe1zQ9Mxo-UobJydZYtU7NJ6niyA8HXZdztfGZQkFnkHXK3x8twPqUSBalSi8UPDt5MjzJgntJOEgYrjIUPDuf0dhU-3PjivSwYBQBJZMyMr0vCTLpLAbMWeP7bgTmNzfJZAwYV2JhFDEPdkb9ho2IbajlWVk0ijMTzNiOVyznl0pmmmU1ikPf_rWjAx65Ciuy748BezOq5RINEfUFb0zv3krdV3ixajpHWUdqViioC-dhvucw471vmdm_W1Nfr-_HzuHJ7ap-iOP0vzLFmZCT8HSd8nCOCrZB_VBdfy9gVDhLvAEqhGI7hXGOicNb0UwEjBkzZ9wJMLPKL5hJ6athyHfSfQMm6rx6khLlc3kIh6whrv0Gpy8jivAz_ytYKG9fxykk2fW2-lB1URozah_g9JtMZ8A44prS_AofACLI1tQG7e1ljMyzfRTD48XCR6jFewxtl_Eaokqaq8u53m5sHjYRyb_KxRJ_qv-5TijNnd_Rqu33orko-yYF7DPqdX4Hj9IdcDd5_t0sL3jnPoKlqAWQkPSuuvo8HEN-Xo9Y9jR7-AUyvFOog9WeG-E9feV_AnR4E1u_XK3SErYtuO1qDfvCo38DKYE2Eg5LXg-0xUo6izmRB0BCaePDloYEUOI-95MLtq88u4SiRW8G7fBGAO4HqV2os9CfGSLfqWKUYVX6SdxQUwka5bKQG1ror2KDuP_BR0duQwb6e8MChoFn6YCT66KO3iSO2VoVP8fUCUVTBQmjy5Gz4Fr4b0DJCXc-biVYXK5K0vAE2akXAtVVaXo7lM3cwJBqd_9FoNcWtpcTz6IUUqkiyo6NL_w6vAxvouuICLpw5sh-XNLUZ47EtWviC3Ef4yxgqAivDnywuaBHNFywLi5G9OcRlvlTdbk4eTd8NQNsM7X9C8B-zzCDBEDl_6FnLqMavewCEJpXbuDP6OZ03cwj0NccFjxyc1cfbUAzzSXUZJI-MY-POF4jjwSVNLlHPHD0rmqWLUHobnyLpyIB_Pxql12GZOuVcY-oi_2OZYBDppgepsU-Q351eRpZLQaOowY-RCARs73edMb73YHHuzXT_BIhWMWit_KEiqiwBsC57IjFGtMftUx7LmedHfTe-a3qjXRap34G4AXUEy2X0LRDSOEVWcRgurNabgcbrqy3MsI714seS_3-d28GPktE9SROHKkyCYvc6X9yJhOBX4zx0f0yozHAKdrGcorKwgN2aUsaVgZD4APUDa-7E6jcIrlc8JuqseihZBb3W2YJjROdlrJlMcMtgZXJyJhg0flXJIx_rJfbobK-bOOu3F88bgMSDY4bADBXWHagepBHNZMLxNxDx_GQ84gZyS5IbNxanzF-gm5WnpRwhyrZH70p4xngNYFEApc4cfQ.8yoBfVkFdjSudnGS6tmqOQ'
api = ChatGPT(session_token)

#message = 
url = ("https://api.telegram.org/bot5873778396:AAGOiPTwqq03ABocRX74aqE0BcwZZIm9Kwk")
#url_msg = 'https://api.telegram.org/bot5873778396:AAGOiPTwqq03ABocRX74aqE0BcwZZIm9Kwk/sendMessage?chat_id=-867171943&text="{}"'.format(message)

api.reset_conversation()
def read_msg(offset):
  parameter = { "offset" : offset}
  resp = requests.get(url + "/getUpdates", data= parameter)
  data = resp.json()

  print(offset)

  for result in data["result"]:
    print(result["message"]["text"])
    resp = api.send_message(result["message"]["text"])
    print(resp['message'])
    
    parameters ={"chat_id" : "-867171943", "text" : resp['message']}
    respo = requests.get(url + "/sendMessage", data= parameters)
    time.sleep(5)

  if data["result"]:
    return data["result"][-1]["update_id"] + 1
  


def send_msg():
  parameters ={"chat_id" : "-867171943",
               "text" : "sending msg"}
  resp = requests.get(url + "/sendMessage", data= parameters)


offset = 918801329
while True:

  offset = read_msg(offset)
  time.sleep(1)
